<div class='reservation-index'>
    <div class='reservation_all'>
        <div class='search'>
            <div class='search-for-reservation'>
                <h3>予約検索<span class='font-color name-margin'>予約を削除したい場合はこちらをご利用ください</span></h3>
                
<!-------検索フォーマット----------------------------------------------------------------->
                    <%= form_tag(search_reservations_path, :method => 'get') do   %>
                        <div class='search_form'>
                            <p>お客様名前（性、カナ）</p>
                            <%= text_field_tag :search_last_kana %>
                            
                            <p>お客様名前（名、カナ）</p>
                            <%= text_field_tag :search_first_kana %>
                            
                            <p>来店予定日</p>
                                <select name= 'search_date'>
                                    <% @dates.each do |date| %>
                                        <option value="<% date %>"><%= date.strftime("%Y年 %m月 %d日") %></option>
                                        <% logger.debug ("-----------date=#{date}") %>
                                    <% end %>
                                </select>
                            
                            <p>担当スタイリスト</p>
                                <select name= 'search_staff'>
                                    <% @staffs.each do |staff| %>
                                        <option value="<% staff.id %>"><%= staff.last_name %><%= staff.first_name %></option>
                                    <% end %>
                                </select>
                        </div>       
                    <% end %>
            </div>
        <hr>
        
<!-------検索結果を表示------------------------------------------------------------------>
            <div class='selected-reservations'>
                <% @searchedReservations.each do |reservation| %>
                    <div class='reservation-inner'>
                        <div class='reservations-top-side'>
                            <div class='reservation-date'>
                                <%= reservation.date %>
                            </div>
                            <div class='reservation-frames'>
                                <!----- StringをJSON.parseでArray化 -->
                                <% frames = JSON.parse(reservation.frames) %>
                                <% frames.each do |frame| %>
                                <%= frame %>
                                <% end %>
                            </div>
                            <div class='reservation-menus'>
                                <!----- StringをJSON.parseでArray化 -->
                                <% menuIds = JSON.parse(reservation.menu_ids) %>
                                <% menuIds.each do |menuId| %>
                                    <% menu = Menu.find_by(id: menuId) %>
                                    <%= menu.name %>
                                    <%= menu.price %>
                                <% end %>
                            </div>
                        </div>
                        <div class='reservation-down-side'>
                            <div class='reservation-custamer_detail'>
                                <div class='reservation_custermer_name'>
                                    <p><%= reservation.last_name_kana %><span class='name-margin'><%= reservation.first_name_kana %></span></p>
                                    <p><%= reservation.last_name %><span class='name-margin'><%= reservation.first_name %></span></p>
                                </div>
                                <div class='reservation-gender'>
                                    <%= reservation.gender %>
                                </div>
                                <div class='reservation-tel-email'>
                                    <p><%= reservation.tel %></p>
                                    <p><%= reservation.email %></p>
                                </div>
                            </div>
                        </div>
                    </div>
                <% end %>
            </div>
        </div>
        
<!-------予約一覧----------------------------------------------------------------->        
        <div class='reservations-inners'>
            <h3>予約一覧</h3>
            <% @reservations.each do |reservation| %>
                <div class='reservation-inner'>
                    <div class='reservations-top-side'>
                        <div class='reservation-date'>
                            <%= reservation.date %>
                        </div>
                        <div class='reservation-frames'>
                            <!----- StringをJSON.parseでArray化 -->
                            <% frames = JSON.parse(reservation.frames) %>
                            <% frames.each do |frame| %>
                            <%= frame %>
                            <% end %>
                        </div>
                        <div class='reservation-menus'>
                            <!----- StringをJSON.parseでArray化 -->
                            <% menuIds = JSON.parse(reservation.menu_ids) %>
                            <% menuIds.each do |menuId| %>
                                <% menu = Menu.find_by(id: menuId) %>
                                <%= menu.name %>
                                <%= menu.price %>
                            <% end %>
                        </div>
                    </div>
                    <div class='reservation-down-side'>
                        <div class='reservation-custamer_detail'>
                            <div class='reservation_custermer_name'>
                                <p><%= reservation.last_name_kana %><span class='name-margin'><%= reservation.first_name_kana %></span></p>
                                <p><%= reservation.last_name %><span class='name-margin'><%= reservation.first_name %></span></p>
                            </div>
                            <div class='reservation-gender'>
                                <%= reservation.gender %>
                            </div>
                            <div class='reservation-tel-email'>
                                <p><%= reservation.tel %></p>
                                <p><%= reservation.email %></p>
                            </div>
                        </div>
                    </div>
                </div>
            <% end %>
        </div>
    </div>
</div>